(function(a){a.fn.wBox=function(t){var F=true;var k=window.document;var h=window;if(this[0].ownerDocument&&this[0].ownerDocument.parentWindow){if(window==this[0].ownerDocument.parentWindow){F=true}else{F=false;k=this[0].ownerDocument.parentWindow.document;h=this[0].ownerDocument.parentWindow;if(!g("com.newland.dialog.NLPopupBox","css")){m(J("com.newland.dialog.NLPopupBox")+"com.newland.dialog.NLPopupBox.css");m(J("com.newland.dialog.NLPopupBox")+"com.newland.dialog.NLPopupBox.min.css")}if(!g("com.newland.button.NLFilletButton","css")){m(J("com.newland.button.NLFilletButton")+"com.newland.button.NLFilletButton.css");m(J("com.newland.button.NLFilletButton")+"com.newland.button.NLFilletButton.min.css")}if(!g("com.newland.button.NLFilletButton","js")){w(J("com.newland.button.NLFilletButton")+"com.newland.button.NLFilletButton.js")}}}else{if(this[0].parentWindow){if(window==this[0].parentWindow){F=true}else{F=false;k=this[0];h=this[0].parentWindow;if(!g("com.newland.dialog.NLPopupBox","css")){m(J("com.newland.dialog.NLPopupBox")+"com.newland.dialog.NLPopupBox.css");m(J("com.newland.dialog.NLPopupBox")+"com.newland.dialog.NLPopupBox.min.css")}if(!g("com.newland.button.NLFilletButton","css")){m(J("com.newland.button.NLFilletButton")+"com.newland.button.NLFilletButton.css");m(J("com.newland.button.NLFilletButton")+"com.newland.button.NLFilletButton.min.css")}if(!g("com.newland.button.NLFilletButton","js")){w(J("com.newland.button.NLFilletButton")+"com.newland.button.NLFilletButton.js")}}}else{if(this[0].document){if(window==this[0]){F=true}else{F=false;k=this[0].document;h=this[0];if(!g("com.newland.dialog.NLPopupBox","css")){m(J("com.newland.dialog.NLPopupBox")+"com.newland.dialog.NLPopupBox.css");m(J("com.newland.dialog.NLPopupBox")+"com.newland.dialog.NLPopupBox.min.css")}if(!g("com.newland.button.NLFilletButton","css")){m(J("com.newland.button.NLFilletButton")+"com.newland.button.NLFilletButton.css");m(J("com.newland.button.NLFilletButton")+"com.newland.button.NLFilletButton.min.css")}if(!g("com.newland.button.NLFilletButton","js")){w(J("com.newland.button.NLFilletButton")+"com.newland.button.NLFilletButton.js")}}}}}function g(S,B){var Q=(B=="js")?"script":(B=="css")?"link":"none";var P=(B=="js")?"src":(B=="css")?"href":"none";var R=k.getElementsByTagName(Q);for(var C=R.length;C>=0;C--){if(R[C]&&R[C].getAttribute(P)!=null&&R[C].getAttribute(P).indexOf(S)!=-1){return true}}return false}function m(i){var B=k.createElement("link");B.setAttribute("rel","stylesheet");B.setAttribute("type","text/css");B.setAttribute("href",i);B.setAttribute("isD",true);if(typeof B!="undefined"){k.getElementsByTagName("head")[0].appendChild(B)}}function w(B){var i=k.createElement("script");i.setAttribute("type","text/javascript");i.setAttribute("href",B);i.setAttribute("isD",true);if(typeof i!="undefined"){k.getElementsByTagName("head")[0].appendChild(i)}}this.data("_index",(Math.random()+"").substring(2));function J(Q){var C=document.getElementsByTagName("script");for(var B=0;B<C.length;B++){if(C[B].src.lastIndexOf(Q)>=0){var P=C[B].src.replace(/\\/gi,"/");return P.substring(0,P.lastIndexOf("/")+1)}}return""}var A={opacity:0.5,callBack:null,noTitle:false,show:false,bgcolor:"#FAFAFB",timeout:0,target:null,requestType:null,title:"\u5f39\u51fa\u6846",drag:true,noButtons:false,iframeWH:{width:400,height:300},html:""},e=this;this._param=a.extend(A,t);this._param.button_padding=3;if(!this._param.noButtons){var O={align:"center",padding:this._param.button_padding,configs:{nlpopupbox_confirm:{id:"nlpopupbox_confirm",displayname:"\u786e\u8ba4",pic_src:J("com.newland.dialog.NLPopupBox")+"images/confirm.gif",hide:false,onpress:function(){e.close();return false}},nlpopupbox_cancel:{id:"nlpopupbox_cancel",displayname:"\u53d6\u6d88",pic_src:J("com.newland.dialog.NLPopupBox")+"images/cancel.gif",hide:false,onpress:function(i){e.close();return false}}}};if(!t.buttons){this._param.buttons={align:O.align,padding:O.padding,configs:[O.configs.nlpopupbox_confirm,O.configs.nlpopupbox_cancel]}}else{var z=false,E=false;for(var K=0;K<this._param.buttons.configs.length;K++){if(this._param.buttons.configs[K]&&this._param.buttons.configs[K].id=="nlpopupbox_confirm"){this._param.buttons.configs[K]=a.extend(O.configs.nlpopupbox_confirm,this._param.buttons.configs[K]);z=true}if(this._param.buttons.configs[K]&&this._param.buttons.configs[K].id=="nlpopupbox_cancel"){this._param.buttons.configs[K]=a.extend(O.configs.nlpopupbox_cancel,this._param.buttons.configs[K]);E=true}if(z&&E){break}}if(!z){this._param.buttons.configs.push(O.configs.nlpopupbox_confirm)}if(!E){this._param.buttons.configs.push(O.configs.nlpopupbox_cancel)}if(this._param.buttons.padding==undefined){this._param.buttons.padding=this._param.button_padding}}}var G=c(),M=n();var q="";if(a.browser.msie&&(a.browser.version==6||a.browser.version==7)&&!F){q=(e._param.noTitle?"":'<table class="wBox_title"><tr><td class="wBox_dragTitle"><div class="wBox_itemTitle">'+e._param.title+'</div></td><td><div class="wBox_close"></div></td></tr></table> ')+'<div class="wBox_content'+(e._param.noTitle?" wBox_content_notitle":"")+'" id="wBoxContent'+a(e).data("_index")+'"></div>'}else{q='<div id="wBox'+a(e).data("_index")+'" class="wBox">'+(e._param.noTitle?"":'<table class="wBox_title"><tr><td class="wBox_dragTitle"><div class="wBox_itemTitle">'+e._param.title+'</div></td><td><div class="wBox_close"></div></td></tr></table> ')+'<div class="wBox_content'+(e._param.noTitle?" wBox_content_notitle":"")+'" id="wBoxContent'+a(e).data("_index")+'"></div>'}if(!this._param.noButtons&&e._param.buttons.configs.length){q=q+'<table class="wBox_btn"><tr><td><ul>';if(e._param.buttons.align=="right"){e._param.buttons.configs.reverse()}for(var K=0;K<e._param.buttons.configs.length;K++){var N=e._param.buttons.configs[K];q=q+'<li><a id="'+N.id+'" href="#" '+(N.pic_src?'pic_src="'+N.pic_src+'" ':"")+'button_type="nl_fillet_button">'+N.displayname+"</a></li>"}q=q+"</ul></td></tr></table>"}var p=null,o=null,x=a(window),b=a(this);if(!F){b=a(k);x=a(h)}var l=0,v=0;this.show=function(){if(F){j(e.data("_index"))}a("#wBox_overlay"+a(e).data("_index")).remove();a("#wBox"+a(e).data("_index")).remove();if(F){p=a("<div id='wBox_overlay"+a(e).data("_index")+"' class='wBox_hide'></div>").hide().addClass("wBox_overlayBG").css("opacity",e._param.opacity).appendTo("body").show()}else{if(a.browser.msie&&(a.browser.version==6||a.browser.version==7)){var B=b[0].createElement("div");B.id="wBox_overlay"+a(e).data("_index");B.className="wBox_hide wBox_overlayBG";b[0].body.appendChild(B);p=a("#wBox_overlay"+a(e).data("_index"),b[0]);p.css("opacity",e._param.opacity)}else{p=a("<div id='wBox_overlay"+a(e).data("_index")+"' class='wBox_hide'></div>").hide().addClass("wBox_overlayBG").css("opacity",e._param.opacity).appendTo(b[0].body).show()}}if(a.browser.msie&&a.browser.version==6){var i='<iframe style="display: block; z-index: -1; left: -1px;width: 100%; 		position: absolute; top: -1px; 		height: 100%; 		tabIndex=-1 src="javascript: return;" frameBorder=0>	</iframe>';p.prepend(i)}if(F){o=a(q).appendTo("body")}else{if(a.browser.msie&&(a.browser.version==6||a.browser.version==7)){var C=b[0].createElement("div");C.id="wBox"+a(e).data("_index");C.className="wBox";C.innerHTML=q;b[0].body.appendChild(C);o=a("#wBox"+a(e).data("_index"),b[0])}else{o=a(q).appendTo(b[0].body)}}d();s();if(this._param.noTitle==false){a("#wBox"+a(e).data("_index")).find(".wBox_content").css("margin-bottom","6px")}};function c(){var P=a("div.wBox",a(k)),B=108;for(var C=0;C<P.length;C++){B+=2}return B}function n(){var P=a("div.wBox_overlayBG",a(k)),B=106;for(var C=0;C<P.length;C++){B+=2}return B}function r(){a("#wBox"+a(e).data("_index"),a(k)).css("z-index",G);a("#wBox_overlay"+a(e).data("_index"),a(k)).css("z-index",M)}function d(){var B=null;if(a.browser.msie&&(a.browser.version==6||a.browser.version==7)){B=b.find("#wBoxContent"+a(e).data("_index"),a(k))}else{B=o.find("#wBoxContent"+a(e).data("_index"),a(k))}if(e._param.requestType&&a.inArray(e._param.requestType,["iframe","ajax","img"])!=-1){if(a.browser.msie&&(a.browser.version==6||a.browser.version==7)){var i=b[0].createElement("div");i.className="wBox_load";B.empty().append(i)}else{B.html("<div class='wBox_load'></div>")}if(e._param.requestType==="img"){var C=null;if(a.browser.msie&&(a.browser.version==6||a.browser.version==7)){C=b[0].createElement("img");C.src=e._param.target;B.empty().append(C);I();H()}else{C=a("<img />");C.attr("src",e._param.target);C.load(function(){C.appendTo(B.empty());I();H()})}}else{if(e._param.requestType==="ajax"){a.get(e._param.target,function(T){B.html(T);I();H()})}else{var S="wBoxIframe"+a(e).data("_index");if(a.browser.msie&&(a.browser.version==6||a.browser.version==7)){var Q=b[0].createElement("iframe");Q.id=S;Q.name="wBoxIframe";Q.style.width=e._param.iframeWH.width;Q.style.height=e._param.iframeWH.height;Q.src=e._param.target;Q.scrolling="auto";Q.frameborder="0";B.empty().append(Q)}else{B.empty().append("<iframe id="+S+" name='wBoxIframe' style='width:"+e._param.iframeWH.width+"px;height:"+e._param.iframeWH.height+"px;' scrolling='auto' frameborder='0' src='"+e._param.target+"'></iframe>")}H()}}}else{if(e._param.target){if(F){L();a(e._param.target).show().appendTo(B.empty())}else{if(a.browser.msie&&(a.browser.version==6||a.browser.version==7)){var P=a(e._param.target).clone(true);var R=b[0].createElement("div");R.innerHTML=P.html();B.empty().append(R)}else{a(e._param.target).clone(true).show().appendTo(B.empty())}}}else{if(e._param.html){B.html(e._param.html)}else{b.clone(true).show().appendTo(B.empty())}}H()}u();r()}function H(){o.find(".wBox_btn").width(o.width());o.find(".wBox_title").width(o.width());o.find(".wBox_dragTitle").width(o.width()-20)}function u(){I();o.show().find(".wBox_close").click(function(i){e.close();return false}).hover(function(){a(this).addClass("on")},function(){a(this).removeClass("on")});a(b[0]).unbind("keydown.wBox").bind("keydown.wBox",function(i){if(i.keyCode===27){e.close()}return true});!e._param.noTitle&&e._param.drag?f():null;if(e._param.timeout){setTimeout(e.close,e._param.timeout)}if(!e._param.noButtons){for(var B=0;B<e._param.buttons.configs.length;B++){if(e._param.buttons.configs[B]&&e._param.buttons.configs[B].id&&e._param.buttons.configs[B].id!=""){if(o.find("#"+e._param.buttons.configs[B].id)){if(o.find("#"+e._param.buttons.configs[B].id).fillet){o.find("#"+e._param.buttons.configs[B].id).fillet()}if(e._param.buttons.configs[B].onpress){o.find("#"+e._param.buttons.configs[B].id)[0].onclick=function(){var i=B;return function(){e._param.buttons.configs[i].onpress();return false}}()}if(e._param.buttons.configs[B].hide){o.find("#"+e._param.buttons.configs[B].id).hide()}o.find("#"+e._param.buttons.configs[B].id).css("margin-left",e._param.buttons.padding+"px")}}}o.find(".wBox_btn ul").addClass("align_middle");if(e._param.buttons.align=="left"){o.find(".wBox_btn ul").removeClass("align_middle")}else{if(e._param.buttons.align=="right"){o.find(".wBox_btn ul").removeClass("align_middle").addClass("align_right")}}}if(e._param.bgcolor){o.find(".wBox_content").css("background-color",e._param.bgcolor)}}function I(){if(!o){return false}var C=y();o.css({left:C[0],top:C[1]});var B=a(b[0]).height(),i=x.height(),P=a("html").height();B=Math.max(B,i);p.height(B).width(x.width())}function y(B){var P=l,Q=v,i,C;if(!B){if(P==0){P=o.width()}if(Q==0){Q=o.height()}}else{P=B;Q=o.height()}i=(x.width()-P)/2;C=(x.height()-Q)/2;i=a(k).scrollLeft()+i;C=a(k).scrollTop()+C;if(i<0){i=0}if(C<0){C=0}return[i,C]}function f(){var V,U,S,B,R;var C=o.find(".wBox_dragTitle").css("cursor","move");C.bind("selectstart",function(){return false});C.mousedown(function(T){V=T.clientX-parseInt(o.css("left"));U=T.clientY-parseInt(o.css("top"));o.mousemove(i).mouseout(P).css("opacity",0.8);C.mouseup(Q)});function i(T){S=false;if(T.clientX-(V+a(k).scrollLeft())<0){B=a(k).scrollLeft()}else{if(T.clientX-(V+a(k).scrollLeft())>x.width()-o.width()){B=x.width()-o.outerWidth()+a(k).scrollLeft()}else{B=T.clientX-V}}if(T.clientY-(U+a(k).scrollTop())<0){R=a(k).scrollTop()}else{if(T.clientY-(U+a(k).scrollTop())>x.height()-o.height()){R=x.height()-o.outerHeight()+a(k).scrollTop()}else{R=T.clientY-U}}o.css({left:B,top:R})}function P(T){S=true;setTimeout(function(){S&&Q(T)},10)}function Q(T){o.unbind("mousemove",i).unbind("mouseout",P).css("opacity",1);C.unbind("mouseup",Q)}}function j(i){if(a("#nlpopupbox_target_temp"+i).length){a("#nlpopupbox_target_temp"+i).replaceWith(a(e._param.target).hide())}}function L(){if(!a("#nlpopupbox_target_temp"+a(e).data("_index")).length){a(e._param.target).wrap('<div id="nlpopupbox_target_temp'+a(e).data("_index")+'" style="display: none;"></div>')}}function D(S,B){var Q=(B=="js")?"script":(B=="css")?"link":"none";var P=(B=="js")?"src":(B=="css")?"href":"none";var R=k.getElementsByTagName(Q);for(var C=R.length;C>=0;C--){if(R[C]&&R[C].getAttribute(P)!=null&&R[C].getAttribute("isD")==true&&R[C].getAttribute(P).indexOf(S)!=-1){R[C].parentNode.removeChild(R[C])}}}this.close=function(i){if(o){if(o.find("iframe").length){o.find("iframe")[0].src=""}if(F){j(o.attr("id").substring("wBox".length))}p.remove();if(!F){}o.stop().remove();if(!i&&e._param.callBack&&typeof e._param.callBack=="function"){e._param.callBack()}}};function s(){if(o){l=o.width();v=o.height()}}a(h).resize(function(){setTimeout(I,1)});this.getIframeObj=function(){var i=o.find("#wBoxContent"+a(e).data("_index"));if(i.length>0){var C="wBoxIframe"+a(e).data("_index");var B=k.getElementById(C);if(B){return B.contentWindow.document}else{return null}}};this.getIframe=function(){var i=o.find("#wBoxContent"+a(e).data("_index"));if(i.length>0){var C="wBoxIframe"+a(e).data("_index");var B=k.getElementById(C);if(B){return B}else{return null}}};e._param.show?e.show():null;return this}})(jQuery); 
  